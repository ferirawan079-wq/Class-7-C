<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MTS Al Washliyah Kolam — Kelas VII-C (Interactive)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --white:#ffffff; --dark:#061221;
    --blue:#007bff; --green:#00c851; --accent1:#00bfff;
    --glass: rgba(255,255,255,0.85);
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; background:linear-gradient(135deg,#e6f7ff,#e6ffe9 50%,#ffffff 100%); font-family:'Poppins',sans-serif; color:var(--dark); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
  .wrap{max-width:1200px; margin:22px auto; padding:18px;}
  header.site{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:14px; border-radius:14px; background:linear-gradient(90deg, rgba(255,255,255,0.95), rgba(255,255,255,0.8)); box-shadow:0 12px 40px rgba(2,17,36,0.06);}
  .brand{display:flex; gap:14px; align-items:center}
  .logo{width:72px;height:72px;border-radius:14px;background:linear-gradient(135deg,var(--blue),var(--green)); display:flex;align-items:center;justify-content:center;color:white;font-weight:800;font-size:20px;box-shadow:0 8px 30px rgba(0,123,255,0.12)}
  .hdr-text h1{margin:0;font-size:20px}
  .hdr-text p{margin:3px 0 0;font-size:13px;color:rg>ba(0,0,0,0.55)}
  .userArea{ text-align:right; font-size:13px; color:rgba(0,0,0,0.6) }

  /* layout */
  .grid{display:grid; grid-template-columns: 1fr 420px; gap:20px; margin-top:18px;}
  @media(max-width:980px){ .grid{grid-template-columns:1fr} .rightCol{order:2} .leftCol{order:1} }

  .card{background:var(--glass); border-radius:14px; padding:16px; box-shadow:0 12px 30px rgba(2,17,36,0.06); overflow:hidden}
  .title {font-weight:700; margin:0 0 6px; color:var(--dark)}
  p.lead {margin:6px 0 0; color:rgba(0,0,0,0.6)}

  /* LOGIN overlay */
  #loginOverlay{position:fixed; inset:0; background:linear-gradient(180deg, rgba(2,17,36,0.75), rgba(2,17,36,0.88)); display:flex; align-items:center; justify-content:center; z-index:9999}
  #loginCard{width:min(820px,96%); border-radius:16px; padding:26px; background:linear-gradient(135deg,#ffffff,#f2fdff); box-shadow:0 40px 120px rgba(0,0,0,0.5); display:flex; gap:18px; align-items:center}
  #loginLeft{flex:1}
  #loginLeft h1{margin:0;font-size:34px;color:var(--dark)}
  #loginLeft p{margin:8px 0 14px;color:rgba(0,0,0,0.6)}
  #username{width:80%; padding:14px; border-radius:12px; border:2px solid rgba(0,123,255,0.14); font-size:16px; display:block; margin-bottom:12px}
  #loginBtn{padding:14px 20px; border-radius:12px; border:none; font-weight:700; color:white; background:linear-gradient(90deg,var(--blue),var(--green)); cursor:pointer; box-shadow:0 10px 30px rgba(0,123,255,0.12)}
  #loginError{color:#c33; margin-top:8px}

  /* login visual right */
  #loginRight{width:340px; display:flex;align-items:center;justify-content:center; position:relative}
  #loginCanvas{width:320px;height:320px;border-radius:14px; box-shadow:0 12px 40px rgba(2,17,36,0.12); background:linear-gradient(180deg,#00111a,#001a2a) }

  /* hero content styling */
  .leftCol .section { margin-bottom:14px; animation:fadeUp .6s ease both; }
  @keyframes fadeUp { from {opacity:0; transform:translateY(12px)} to {opacity:1; transform:none} }

  /* schedule table */
  table.schedule{width:100%; border-collapse:separate; border-spacing:8px; margin-top:8px;}
  table.schedule th{padding:10px; text-align:left; background:linear-gradient(90deg,var(--blue),var(--green)); color:white; border-radius:8px; font-weight:700}
  table.schedule td{background:rgba(255,255,255,0.9); padding:10px; border-radius:8px; color:var(--dark)}

  /* piket list */
  .piket-list{display:grid; grid-template-columns: 1fr 1fr; gap:8px}
  .piket-item{background:rgba(255,255,255,0.95); padding:8px; border-radius:8px; color:var(--dark); font-size:14px}

  /* AI animation card */
  .aiCard{position:relative; height:360px; border-radius:12px; overflow:hidden; display:flex; flex-direction:column}
  .aiCanvas{flex:1; display:block; width:100%; height:100%}
  .aiControls{position:absolute; top:12px; right:12px; z-index:8; display:flex; gap:8px}
  .btn{padding:10px 14px; border-radius:10px; border:none; cursor:pointer; font-weight:700}
  .btn.primary{background:linear-gradient(90deg,var(--green),var(--blue)); color:white}
  .btn.ghost{background:rgba(255,255,255,0.9); color:var(--dark)}

  /* quiz card */
  .quizBig{display:flex; flex-direction:column; align-items:center; gap:10px; padding:12px}
  #questionText{font-size:18px; font-weight:700; color:var(--dark)}
  #answerInput{padding:12px; width:80%; border-radius:10px; border:2px solid rgba(0,123,255,0.12); font-size:16px; text-align:center}
  .progressBar{width:80%; background:#e9fbf1; border-radius:12px; overflow:hidden; height:18px}
  .progressFill{height:100%; width:0%; background:linear-gradient(90deg,var(--blue),var(--green)); transition:width .45s}

  /* footer */
  footer.page{margin-top:18px; text-align:center; font-size:13px; color:rgba(0,0,0,0.55)}

  /* small */
  @media(max-width:600px){
    #loginCard{flex-direction:column; padding:18px}
    #loginCanvas{width:260px;height:260px}
    .piket-list{grid-template-columns:1fr}
  }
</style>
</head>
<body>
  <!-- LOGIN -->
  <div id="loginOverlay" role="dialog" aria-modal="true">
    <div id="loginCard" class="card" aria-label="Login ke situs kelas">
      <div id="loginLeft">
        <div style="display:flex; gap:12px; align-items:center;">
          <div class="logo" aria-hidden>AW</div>
          <div>
            <h1>MTS Al Washliyah Kolam</h1>
            <p>Masuk untuk mengakses dashboard Kelas VII-C — masukkan nama lengkap.</p>
          </div>
        </div>
        <input id="username" placeholder="Nama lengkap (contoh: Feri Irawan)" autocomplete="off" />
        <div>
          <button id="loginBtn">Masuk</button>
        </div>
        <div id="loginError" role="status"></div>
      </div>
      <div id="loginRight">
        <canvas id="loginCanvas" aria-hidden></canvas>
      </div>
    </div>
  </div>

  <div class="wrap" id="mainWrap" style="display:none">
    <header class="site" role="banner">
      <div class="brand">
        <div class="logo" aria-hidden>AW</div>
        <div class="hdr-text">
          <h1>MTS Al Washliyah Kolam</h1>
          <p>Website Kelas VII-C • Interaktif</p>
        </div>
      </div>
      <div class="userArea">
        <div id="userNameDisplay">Belum masuk</div>
        <div style="font-size:12px; color:rgba(0,0,0,0.45)">WAKES=UMMI AIDA ADLINA SRG S.Pd</div>
      </div>
    </header>

    <div class="grid"
      <div class="leftCol">
        <!-- profil -->
        <div class="card section">
          <h3 class="title">Profil Singkat</h3>
          <p class="lead"><strong>MTS Al Washliyah Kolam</strong> — Mendidik generasi islami, cerdas, berakhlak. Kelas VII-C fokus pada pengembangan akademik dan bakat siswa.</p>
        </div>

        <!-- jadwal -->
        <div class="card section">
          <h3 class="title">Jadwal Pelajaran — Kelas VII-C</h3>
          <p class="lead">Berikut jadwal pelajaran mingguan untuk Kelas VII-C (kolom VII-C pada roster sekolah). Jam disederhanakan menjadi rentang umum tiap hari.</p>
          <table class="schedule" role="table" aria-label="Jadwal pelajaran">
            <thead>
              <tr><th>Hari</th><th>Jam</th><th>Mata Pelajaran (singkatan)</th></tr>
            </thead>
            <tbody>
              <tr><td>Senin</td><td>07:15 - 14:45</td><td>MM-SKI-BIN-TIK</td></tr>
              <tr><td>Selasa</td><td>07:15 - 14:45</td><td>B.A-IPS-BIG-TAH-PKN</td></tr>
              <tr><td>Rabu</td><td>07:15 - 14:45</td><td>IPA-FIQ-MM-QH-PK</td></tr>
              <tr><td>Kamis</td><td>07:15 - 14:45</td><td>BA-IPS-AW-BIN-AA-IPA</td></tr>
              <tr><td>Jumat</td><td>07:15 - 11.30</td><td>PJOK-S.RUP-BIG</td></tr>
              <tr><td>Sabtu</td><td>07:15 - 11.30</td><td><strong>Senam & Penampilan Bakat</strong></td></tr>
            </tbody>
          </table>
        </div>

        <!-- piket -->
        <div class="card section">
          <h3 class="title">Jadwal Piket VII-C</h3>
          <p class="lead">Pembagian piket diambil dari daftar kelas (sesuai poster/roster).</p>
          <div class="piket-list" role="list">
            <div class="piket-item"><b>Senin:</b><br>Aditya, Hamid, Fauzi, Nurhasana, Melisa, Rafa S</div>
            <div class="piket-item"><b>Selasa:</b><br>M. Yudika, Rafa A, Azriel, Chelsea, Sabrina, Sherin</div>
            <div class="piket-item"><b>Rabu:</b><br>Ferri (Ferry), Nuril, Mugi, Nadyha, Aqila Zahwa, Tia</div>
            <div class="piket-item"><b>Kamis:</b><br>Riski Okla, Rafa F, Rahmad, Shyfa, Keyla, Wulan</div>
            <div class="piket-item"><b>Jumat:</b><br>Raka, Fikri, Satria, Alifia, Chaira, Riski A</div>
            <div class="piket-item"><b>Sabtu:</b><br>Riskiano, Satrio, Yudi Rafa, Rena, Salsa, Nur Hidayah</div>
          </div>
          <div style="margin-top:8px;font-size:13px;color:rgba(0,0,0,0.5)"><em>Catatan: Hadir tepat waktu. Pembagian mengikuti urutan roster.</em></div>
        </div>

        <!-- quiz -->
        <div class="card section">
          <h3 class="title">Mini Game — Kuis (10 soal)</h3>
          <div class="quizBig" role="region" aria-live="polite">
            <div id="questionText">...</div>
            <input id="answerInput" placeholder="Tulis jawaban singkat (kata/angka) di sini" />
            <div style="display:flex;gap:8px;align-items:center;margin-top:6px">
              <button id="submitBtn" class="btn primary">Kirim Jawaban</button>
              <button id="skipBtn" class="btn ghost">Lewati</button>
            </div>
            <div style="width:100%;display:flex;justify-content:center;margin-top:12px">
              <div class="progressBar" aria-hidden><div class="progressFill" id="progressFill"></div></div>
            </div>
            <div id="quizResult" style="margin-top:8px;font-weight:700;color:var(--dark)"></div>
            <div id="quizHint" style="margin-top:6px;color:rgba(0,0,0,0.55);font-size:13px"></div>
          </div>
        </div>
      </div>

      <!-- right column -->
      <div class="rightCol">
        <div class="card aiCard">
          <div class="aiControls">
            <button id="startRec" class="btn primary">Start Recording</button>
            <button id="stopRec" class="btn ghost" disabled>Stop</button>
          </div>
          <canvas id="aiCanvas" class="aiCanvas" aria-label="Animasi astronot"></canvas>
        </div>

        <div class="card" style="margin-top:12px">
          <h3 class="title">Hasil Rekaman & Informasi</h3>
          <div id="videosArea">Belum ada rekaman</div>
          <div style="margin-top:10px;font-size:13px;color:rgba(0,0,0,0.55)">
            <p style="margin:6px 0"><strong>Instruksi singkat:</strong></p>
            <ol style="padding-left:18px;margin:6px 0;color:rgba(0,0,0,0.6)">
              <li>Masuk dengan nama lengkap pada popup.</li>
              <li>Untuk membuat video animasi: tekan <em>Start Recording</em>, tunggu beberapa detik, lalu tekan <em>Stop</em>.</li>
              <li>Video akan tersedia sebagai file .webm (dapat diunduh).</li>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <footer class="page">© MTS Al Washliyah Kolam — Website Kelas VII-C • Dibuat oleh Feri Irawan</footer>
  </div>

<script>
/* ======================
   LOGIN CANVAS (small astronot loop)
   ====================== */
const loginCanvas = document.getElementById('loginCanvas');
const lctx = loginCanvas.getContext('2d');
function resizeLoginCanvas(){
  loginCanvas.width = loginCanvas.clientWidth;
  loginCanvas.height = loginCanvas.clientHeight;
}
resizeLoginCanvas();
window.addEventListener('resize', resizeLoginCanvas);

let lt=0;
function drawLoginAnim(){
  lctx.clearRect(0,0,loginCanvas.width,loginCanvas.height);
  const W = loginCanvas.width, H = loginCanvas.height;
  // gradient bg
  const g = lctx.createLinearGradient(0,0,W,H);
  g.addColorStop(0,'#001021'); g.addColorStop(1,'#001a2a');
  lctx.fillStyle = g; lctx.fillRect(0,0,W,H);

  // tiny stars
  for(let i=0;i<80;i++){
    const x = (i*47 + (lt*0.3)) % W;
    const y = (i*23 + Math.sin((i+lt)*0.02)*30) % H;
    lctx.fillStyle = 'rgba(255,255,255,'+(0.4+0.6*Math.sin((i+lt)*0.05))+')';
    lctx.fillRect(x,y,1.5,1.5);
  }

  // floating mini astronaut
  const ax = W*0.5 + Math.sin(lt*0.02)*8;
  const ay = H*0.45 + Math.cos(lt*0.015)*10;
  lctx.save(); lctx.translate(ax,ay);
  // body
  lctx.fillStyle = '#fff'; lctx.fillRect(-10,-22,20,36);
  // helmet
  lctx.beginPath(); lctx.arc(0,-30,14,0,Math.PI*2); lctx.fillStyle='#e6f9ff'; lctx.fill();
  lctx.beginPath(); lctx.arc(0,-30,9,0,Math.PI*2); lctx.fillStyle='rgba(0,190,255,0.7)'; lctx.fill();
  lctx.restore();

  lt++;
  requestAnimationFrame(drawLoginAnim);
}
drawLoginAnim();

/* ======================
   LOGIN FLOW
   ====================== */
const loginOverlay = document.getElementById('loginOverlay');
const loginBtn = document.getElementById('loginBtn');
const usernameInput = document.getElementById('username');
const loginError = document.getElementById('loginError');
const mainWrap = document.getElementById('mainWrap');
const userNameDisplay = document.getElementById('userNameDisplay');

loginBtn.addEventListener('click', doLogin);
usernameInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') doLogin(); });

function doLogin(){
  const name = usernameInput.value.trim();
  if(!name){ loginError.textContent = 'Nama lengkap wajib diisi!'; return; }
  loginError.textContent = '';
  loginOverlay.style.display = 'none';
  mainWrap.style.display = 'block';
  userNameDisplay.textContent = name;
}

/* ======================
   MAIN ASTRO CANVAS
   - 2D canvas astronot cinematic
   - captureStream for recording
   ====================== */
const canvas = document.getElementById('aiCanvas');
const ctx = canvas.getContext('2d');

function resizeCanvas(){
  canvas.width = canvas.clientWidth;
  canvas.height = canvas.clientHeight;
}
resizeCanvas();
window.addEventListener('resize', ()=>{ resizeCanvas(); initScene(); });

let width = canvas.width, height = canvas.height;
let stars = [], planets = [], particles = [];
let astronaut = {x:0,y:0,angle:0,phase:Math.random()*10};

function initScene(){
  width = canvas.width; height = canvas.height;
  stars = [];
  for(let i=0;i<180;i++){
    stars.push({x:Math.random()*width, y:Math.random()*height, r:Math.random()*1.6, tw:Math.random()*100});
  }
  planets = [
    {x:width*0.78, y:height*0.72, r:58, hue:200},
    {x:width*0.22, y:height*0.25, r:36, hue:280}
  ];
  astronaut.x = width*0.5; astronaut.y = height*0.45;
  particles = [];
}
initScene();

let time = 0;
function drawScene(){
  ctx.clearRect(0,0,width,height);
  // cosmic gradient
  const g = ctx.createLinearGradient(0,0,width,height);
  g.addColorStop(0,'#02021a'); g.addColorStop(0.5,'#001328'); g.addColorStop(1,'#001824');
  ctx.fillStyle = g; ctx.fillRect(0,0,width,height);

  // twinkling stars
  for(let i=0;i<stars.length;i++){
    const s = stars[i];
    const alpha = 0.3 + 0.7*Math.abs(Math.sin((time*0.02) + s.tw*0.01));
    ctx.fillStyle = `rgba(255,255,255,${alpha})`;
    ctx.beginPath(); ctx.arc(s.x, s.y, s.r, 0, Math.PI*2); ctx.fill();
  }

  // slow orbit lines (subtle)
  for(let p of planets){
    ctx.beginPath();
    ctx.ellipse(p.x, p.y, p.r*1.6, p.r*0.8, Math.sin(time*0.002)*0.3, 0, Math.PI*2);
    ctx.strokeStyle = `rgba(255,255,255,0.02)`; ctx.lineWidth = 2; ctx.stroke();
  }

  // draw planets
  for(let p of planets){
    const pg = ctx.createRadialGradient(p.x - p.r*0.3, p.y - p.r*0.4, p.r*0.1, p.x, p.y, p.r*1.4);
    pg.addColorStop(0, `hsla(${p.hue},80%,60%,0.95)`);
    pg.addColorStop(1, `hsla(${p.hue+30},60%,25%,0.12)`);
    ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fillStyle=pg; ctx.fill();
  }

  // floating light fog near bottom
  const fog = ctx.createLinearGradient(0,height*0.6,width,height);
  fog.addColorStop(0,'rgba(0,120,255,0.06)'); fog.addColorStop(1,'rgba(0,255,180,0.01)');
  ctx.fillStyle = fog; ctx.fillRect(0,height*0.6,width,height*0.4);

  // astronaut movement
  astronaut.x = width*0.5 + Math.sin((time+astronaut.phase)*0.012)*Math.min(120, width*0.08);
  astronaut.y = height*0.45 + Math.cos((time+astronaut.phase)*0.01)*Math.min(40, height*0.03);
  astronaut.angle = Math.sin(time*0.004)*0.12;

  // draw astronaut with jetpack
  drawAstronaut(astronaut.x, astronaut.y, astronaut.angle);

  // particles (jet flames + float embers)
  for(let i=particles.length-1;i>=0;i--){
    const p = particles[i];
    p.x += p.vx; p.y += p.vy; p.vy += 0.03*(p.ay || 1);
    p.life--;
    ctx.beginPath();
    ctx.fillStyle = `rgba(255, ${120 + Math.floor(Math.random()*80)}, 60, ${Math.max(0,p.life/60)})`;
    ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
    if(p.life<=0) particles.splice(i,1);
  }

  time++;
  requestAnimationFrame(drawScene);
}

/* drawAstronaut - stylized 2D astronaut */
function drawAstronaut(cx, cy, angle){
  ctx.save();
  ctx.translate(cx, cy);
  ctx.rotate(angle);

  // shadow / glow
  ctx.beginPath();
  ctx.ellipse(0, 58, 70, 18, 0, 0, Math.PI*2);
  ctx.fillStyle = 'rgba(0,0,0,0.12)'; ctx.fill();

  // body suit
  ctx.fillStyle = '#f4f7fb'; ctx.strokeStyle='#d7e7f6';
  roundRect(ctx, -34, -22, 68, 88, 12); ctx.fill(); ctx.stroke();

  // front panel
  ctx.fillStyle = '#e9f6ff'; roundRect(ctx, -24, -12, 48, 40, 8); ctx.fill();

  // arms
  ctx.save();
  ctx.translate(-44, -6); ctx.rotate(Math.sin(time*0.02)*0.25);
  roundRect(ctx, -6, -6, 14, 36, 8); ctx.fill();
  ctx.restore();
  ctx.save();
  ctx.translate(44, -6); ctx.rotate(-Math.sin(time*0.02)*0.22);
  roundRect(ctx, -8, -6, 14, 36, 8); ctx.fill();
  ctx.restore();

  // helmet
  ctx.beginPath();
  ctx.arc(0, -36, 26, 0, Math.PI*2); ctx.fillStyle='#ffffff'; ctx.fill(); ctx.lineWidth=2; ctx.strokeStyle='rgba(0,0,0,0.06)'; ctx.stroke();
  // visor
  const vg = ctx.createLinearGradient(-18,-46,18,-26);
  vg.addColorStop(0,'rgba(10,40,90,0.95)'); vg.addColorStop(1,'rgba(0,180,255,0.6)');
  ctx.beginPath(); ctx.ellipse(0,-36,18,14,0,0,Math.PI*2); ctx.fillStyle=vg; ctx.fill();

  // little reflection
  ctx.beginPath(); ctx.fillStyle='rgba(255,255,255,0.18)'; ctx.ellipse(-8,-44,5,3, -0.4, 0, Math.PI*2); ctx.fill();

  // jetpack box
  ctx.fillStyle='#e6eef6'; roundRect(ctx, -22, 18, 44, 28, 6); ctx.fill(); ctx.strokeStyle='rgba(0,0,0,0.06)'; ctx.stroke();

  // thruster flames
  const flameCount = 2 + Math.floor(Math.random()*3);
  for(let i=0;i<flameCount;i++){
    const fx = (Math.random()-0.5)*20;
    const fy = 46 + Math.random()*6;
    particles.push({x: cx + fx, y: cy + fy, vx: (Math.random()-0.5)*0.6, vy: 2 + Math.random()*2, size: 2 + Math.random()*3, life: 40 + Math.random()*40});
  }

  ctx.restore();
}

/* helper roundRect */
function roundRect(ctx, x, y, w, h, r) {
  ctx.beginPath();
  ctx.moveTo(x + r, y);
  ctx.arcTo(x + w, y, x + w, y + h, r);
  ctx.arcTo(x + w, y + h, x, y + h, r);
  ctx.arcTo(x, y + h, x, y, r);
  ctx.arcTo(x, y, x + w, y, r);
  ctx.closePath();
}

/* start animation */
drawScene();

/* ======================
   RECORDING (canvas.captureStream + MediaRecorder)
   ====================== */
const startRecBtn = document.getElementById('startRec');
const stopRecBtn = document.getElementById('stopRec');
const videosArea = document.getElementById('videosArea');
let mediaRecorder, recordedChunks = [];

startRecBtn.addEventListener('click', async ()=>{
  try {
    const stream = canvas.captureStream(30); // 30 fps
    recordedChunks = [];
    mediaRecorder = new MediaRecorder(stream, { mimeType: 'video/webm; codecs=vp9' });
    mediaRecorder.ondataavailable = (e) => { if(e.data && e.data.size) recordedChunks.push(e.data); };
    mediaRecorder.onstop = () => {
      const blob = new Blob(recordedChunks, { type: 'video/webm' });
      const url = URL.createObjectURL(blob);
      const video = document.createElement('video');
      video.src = url; video.controls = true; video.style.width = '100%';
      const a = document.createElement('a');
      a.href = url; a.download = `astronaut-${Date.now()}.webm`;
      a.textContent = 'Download Rekaman (.webm)';
      a.style.display = 'inline-block';
      a.style.marginTop = '8px';
      videosArea.innerHTML = '';
      videosArea.appendChild(video);
      videosArea.appendChild(a);
    };
    mediaRecorder.start();
    startRecBtn.disabled = true;
    stopRecBtn.disabled = false;
    startRecBtn.textContent = 'Recording...';
  } catch(err) {
    alert('Gagal memulai rekaman: ' + err.message + '. Pastikan browser mendukung MediaRecorder & captureStream.');
  }
});
stopRecBtn.addEventListener('click', ()=>{
  if(mediaRecorder && mediaRecorder.state === 'recording') {
    mediaRecorder.stop();
    startRecBtn.disabled = false;
    stopRecBtn.disabled = true;
    startRecBtn.textContent = 'Start Recording';
  }
});

/* ======================
   QUIZ LOGIC
   - 10 soal, isian singkat, progress bar, nilai akhir
   ====================== */
const quizData = [
  {q:"Siapa pendiri Al Washliyah?", a:"ismail banda"},
  {q:"Tahun berdiri Al Washliyah?", a:"1930"},
  {q:"Siapa nabi terakhir?", a:"nabi muhammad"},
  {q:"Surat pertama dalam Al-Qur'an?", a:"al-fatihah"},
  {q:"5 + 7 = ?", a:"12"},
  {q:"10 x 2 = ?", a:"20"},
  {q:"Khalifah pertama setelah Nabi?", a:"abu bakar"},
  {q:"Bahasa Al-Qur'an?", a:"arab"},
  {q:"Hari raya setelah ramadhan?", a:"idul fitri"},
  {q:"Jumlah huruf hijaiyah (sekitar)?", a:"28"}
];

let currentQ = 0, score = 0;
const questionText = document.getElementById('questionText');
const answerInput = document.getElementById('answerInput');
const submitBtn = document.getElementById('submitBtn');
const skipBtn = document.getElementById('skipBtn');
const progressFill = document.getElementById('progressFill');
const quizResult = document.getElementById('quizResult');
const quizHint = document.getElementById('quizHint');

function loadQuestion(){
  if(currentQ < quizData.length){
    questionText.textContent = (currentQ+1) + '. ' + quizData[currentQ].q;
    answerInput.value = '';
    answerInput.disabled = false;
    submitBtn.disabled = false;
    quizResult.textContent = '';
    quizHint.textContent = `Soal ${currentQ+1} dari ${quizData.length}`;
    progressFill.style.width = ((currentQ)/quizData.length*100) + '%';
    answerInput.focus();
  } else {
    // show result
    const nilai = Math.round((score/quizData.length)*100);
    questionText.textContent = '🎉 Kuis selesai!';
    answerInput.style.display = 'none';
    submitBtn.style.display = 'none';
    skipBtn.style.display = 'none';
    progressFill.style.width = '100%';
    quizResult.textContent = `Nilai kamu: ${nilai} / 100 (Benar: ${score}/${quizData.length})`;
    quizHint.textContent = 'Terima kasih telah bermain!';
  }
}
submitBtn.addEventListener('click', ()=>{
  const ans = answerInput.value.trim().toLowerCase();
  if(ans === ''){
    quizResult.textContent = '⚠ Jawaban tidak boleh kosong!';
    return;
  }
  if(ans === quizData[currentQ].a){
    score++;
    quizResult.textContent = '✅ Jawaban benar!';
  } else {
    quizResult.textContent = `❌ Salah — jawaban benar: ${quizData[currentQ].a}`;
  }
  currentQ++;
  setTimeout(loadQuestion, 900);
});
skipBtn.addEventListener('click', ()=>{
  currentQ++;
  loadQuestion();
});

answerInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') submitBtn.click(); });
loadQuestion();

/* Optional: small entrance animations for cards */
document.querySelectorAll('.card').forEach((c, idx)=>{
  c.style.opacity = 0;
  c.style.transform = 'translateY(12px)';
  setTimeout(()=>{ c.style.transition = 'all .65s cubic-bezier(.2,.9,.3,1)'; c.style.opacity = 1; c.style.transform = 'none'; }, 90*idx);
});
</script>
</body>
</html>